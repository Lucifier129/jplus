/* jplus 2014-12-23 */
(function(t){var e;try{if(define.amd?e=requirejs.s.contexts._.config.paths:define.cmd&&(e=seajs.data.alias),"jquery"in e)define(function(e){var n=e("jquery");return t(n,window),n});else{if(!("zepto"in e))throw Error("No jQuery and Zepto");define(function(e){var n=e("zepto");return t(n,window),n})}}catch(n){t(window.jQuery||window.Zepto||window,window)}})(function(t,e,n){function r(t){return function(){return Function.prototype.call.apply(t,arguments)}}function i(t){return function(e){return null==e?e:d(e)==="[object "+t+"]"}}function o(t,r,i){if(t==n||!b(r))return t;var o,s=t.length,a=0;if(s===+s&&s>0){for(;s>a;a+=1)if(o=r.call(i||e,t[a],a),o!==n)return o;return t}var u,f=O.keys(t);for(s=f.length;s>a;a+=1)if(u=f[a],o=r.call(i||e,t[u],u),o!==n)return o;return t}function s(){var t,e=arguments[0];if("boolean"==typeof e&&(t=e,e=arguments[1]),"object"!=typeof e&&!b(e))return e;var n=g(arguments,t?2:1);return o(n,function(n){"object"==typeof n&&o(n,function(n,r){if(t&&"object"==typeof n){var i=e[r];return e[r]="object"==typeof i?i:{},s(t,e[r],n)}e[r]=n})}),e}function a(t){if(!w(t))return!1;var e,n,r=t.length;if(r>1)for(e=d(t[0]),n=r-1;n>0;n--)if(d(t[n])!==e)return!1;return!0}function u(t){return t+Math.random().toString(36).substr(2)}function f(t){return setTimeout(t,0)}function c(t){var e;return y(t)?e=s(!0,{},t):w(t)?(e=[],o(t,function(t,n){e[n]=c(t)})):e=t,e}function l(t){if(!V.ES5&&t in F)throw Error("If you want to support IE6/7/8. The property name [ "+t+" ] can not be observed, "+"because DOM has the same property name. "+"You can use the [observe.ES5 = true] to ignore IE6/7/8.")}function h(t){t.prevObject=t.context=null,this.$startNode=t,this.viewModel={}}function p(t,e,n){this.dataModel=t,this.viewModel=e,this.startNode=n}var v=Object.prototype,d=r(v.toString),_=r(v.hasOwnProperty),g=r(Array.prototype.slice),y=i("Object"),m=i("String"),b=i("Function"),w=Array.isArray||i("Array");if(!String.prototype.trim){var j=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(j,"")}}var O={keys:Object.keys||function(t){var e=[];if(!y(t))return e;for(var n in t)_(t,n)&&e.push(n);return e},parse:function(t){var e={};if(!m(t))return e;var r=t.trim().split(";");return o(r,function(t){return t=t.trim().split(":"),2>t.length?e[t[0].trim()]="":(e[t[1].trim()]=t[0].trim(),n)}),e}},x=Object.create||function(t){var e=function(){};return e.prototype=t,new e};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=this.length-1;e>=0;e--)if(this[e]===t)return e;return-1});var M=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var i=d(t);if(i!==d(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(b(s)&&s instanceof s&&b(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;n.push(t),r.push(e);var f,c;if(o){if(f=t.length,c=f===e.length)for(;f--&&(c=M(t[f],e[f],n,r)););}else{var l,h=O.keys(t);if(f=h.length,c=O.keys(e).length===f)for(;f--&&(l=h[f],c=_(e,l)&&M(t[l],e[l],n,r)););}return n.pop(),r.pop(),c};O.isEqual=function(t,e){return M(t,e,[],[])};var E,A,N=document,S=N.getElementsByTagName("head")[0],F=N.createComment("Kill IE6/7/8"),q=/\[native code\]/;q.test(Object.defineProperty)&&q.test(Object.create)?A=Object.defineProperty:q.test(Object.prototype.__defineSetter__)&&(A=function(t,e,n){t.__defineGetter__(e,n.get),t.__defineSetter__(e,n.set)});var I;A?(E=!0,I=function(t,e){function n(){o(t.__events__[e],function(n){o(n,function(n){n.call(t,i,e,s)})}),s=c(i),r=!1}if(!(e in t.__events__)){var r,i=t[e],s=c(i);A(t,e,{get:function(){return i},set:function(t){i=t,r||O.isEqual(t,s)||(r=!0,f(n))}})}}):"onpropertychange"in S&&(I=function(t){function e(e,i){var s=n[e],a=t[e];O.isEqual(a,s)||(o(i,function(n){o(n,function(n){n.call(t,a,e,s)})}),n[e]=c(a),r[e]=!1)}if(!t.onpropertychange){var n={},r={};t.each(function(t,e){n[e]=c(t)}),t.onpropertychange=function(t){var n=(t||window.event).propertyName,i=this.__events__;if(n in i){if(r[n])return;r[n]=!0,f(function(){e(n,i[n])})}}}});var k={_add:function(t,e,n){l(t),I(this,t),n=n||u("observer");var r=this.__events__[t]=this.__events__[t]||{};return r[n]=r[n]||[],r[n].push(e),this},on:function(){var t,e=this,n=g(arguments),r=n.length;if(1===r)y(t=n[0])?o(t,function(t,n){e.on(n,t)}):b(t)&&this.each(function(n,r){e._add(r,t,"__all__")});else if(2===r){if(!b(n[1]))return this;if(m(t=n[0])){var i=t.indexOf(".");0>=i?this._add(t,n[1]):this._add(t.substr(0,i),n[1],t.substr(i+1))}else w(t)&&o(t,function(t){e.on(t,n[1])})}return this},_bang:function(t,e,n){var r=this,i=r[t];o(this.__events__[t][n],function(n){n.call(r,e,t,i)})},trigger:function(t,e){var n,r=this;return t?(m(t)?(n=t.indexOf("."),n>0?this._bang(t.substr(0,n),e,t.substr(n+1)):n?o(this.__events__[t]||[],function(n,i){r._bang(t,e,i)}):(t=t.substr(1),o(this.__events__,function(n,i){o(n,function(n,o){o===t&&r._bang(i,e,o)})}))):w(t)&&o(t,function(t){r.trigger(t,e)}),this):this},_remove:function(t,e,n){var r=this.__events__[t][n]||[],i=r.indexOf(e);return-1!==i&&r.splice(i,1),this},off:function(){var t,e,n=this,r=g(arguments),i=r.length;if(i){if(1===i)b(t=r[0])?o(this.__events__,function(e,r){o(e,function(e,i){n._remove(r,t,i)})}):m(t)&&(e=t.indexOf("."),0>=e?this.__events__[t]={}:delete this.__events__[t.substr(0,e)][t.substr(e+1)]);else if(2===i){if(!b(r[1]))return this.off(r[0]),this;m(t=r[0])?(e=t.indexOf("."),0>=e?o(this.__events__[t],function(e,i){n._remove(t,r[1],i)}):this._remove(t.substr(0,e),r[1],t.substr(e+1))):w(t)&&o(t,function(t){n.off(t,r[1])})}}else this.__events__={};return this},offAll:function(){var t=this;return o(this.__events__,function(e,n){t.off([n,"__all__"].join("."))}),this},each:function(t){var e=this;if(this.nodeName)for(var n in this)-1!==e.filter.indexOf(n)||n in F||t.call(e,this[n],n);else o(this,function(n,r){-1===e.filter.indexOf(r)&&t.call(e,n,r)});return this},extend:function(){return s.apply(e,[this].concat(g(arguments)))},once:function(t,e){function n(){e.apply(r,arguments),r.off(n)}var r=this;return t+=".once",this.on(t,n)},tie:function(t,e){if(!b(e))return this;if(w(t)){var n=this,r=t.length,i=[],s=[],a=function(a,u){0>i.indexOf(u)?(i.push(u),i.length===r&&(o(t,function(t,e){t=t.split(".")[0],s[e]=n[t]}),e.apply(n,s))):i.length>=r&&(i.length=0,i.push(u))};return this.on(t,a)}return m(t)?(t=t.split(" "),t.length>1?this.tie(t,e):this.on(t[0],e)):this},collect:function(t,e,n){function r(t){o.push(t),o.length===e&&(n.apply(i,o),i.off(r))}var i=this,o=[];return this.on(t,r)}};k.bind=k.on,k.unbind=k.off,k.fire=k.trigger,k.filter=O.keys(k).concat(["__events__","filter"]);var V=E?function(t,e){if(!y(t))return{};var n=s(x(k),t,{__events__:{}});return y(e)||b(e)?n.on(e):n}:function(t,e){if(!y(t))return{};var n=s(S.appendChild(N.createComment("[object Object]")),k,t,{__events__:{}});return y(e)||b(e)?n.on(e):n};if(V.ES5=!1,V.fn=k,t.observe=V,t!==e){var $=t.plus={attr:"js",filterAttr:["noscan","app"],viewModel:[]},C=r(Array.prototype.push);h.prototype={filter:function(e){var n=[],r=this.$startNode[0],i=r.id=r.id||"filter_id_for_scaner";return o($.filterAttr,function(e){var r=t([i,"["+e+"]","["+$.attr+"]"].join(" "));n.push.apply(n,g(r))}),"filter_id_for_scaner"===i&&(r.removeAttribute?r.removeAttribute("id"):r.id=""),e.filter(function(){return-1===n.indexOf(this)})},parse:function(t){var e=this.viewModel;return o(O.parse(t.attr($.attr)),function(r,i){var o=e[i]=e[i]||{};if(o.instance)C(o.instance,t[0]);else{t.prevObject=null,r=r.split("-"),o.method=r[0],o.params=r.slice(1),o.instance=t,o.lastValue=null,o.alive=t.attr("unalive")!==n?!1:!0,o.template=t.clone(),o.template.prevObject=null;var s=t[0].parentNode;o.parent=/fragment/i.test(s.nodeName)?null:s}}),this},scan:function(){var e=this;return this.parse(this.$startNode).filter(this.$startNode.find("["+$.attr+"]")).each(function(){var n=t(this);n.prevObject=n.context=null,e.parse(n)}),this},rescan:function(){return this.viewModel={},this.scan()},get:function(){return this.viewModel}},t.fn.scanView=function(t){if(!this.length)return{};var e=this[0],n=e.vmIndex;if("number"==typeof n&&!t)return $.viewModel[n].get();var r=$.viewModel[e.vmIndex||(e.vmIndex=$.viewModel.length)]=new h(this);return r.scan().get()};var B=t.fn;p.prototype={refresh:function(){for(var t,e,r=this.viewModel,i=this.dataModel,o=O.keys(r),s=0,a=o.length;a>s;s+=1)e=o[s],t=i[e],t!==n&&this.render(r[e],t)},render:function(e,n){if(!O.isEqual(n,e.lastValue)){e.lastValue=c(n);var r=e.instance,i=B[e.method],o=e.params;if("function"==typeof i)if(a(n)){var s,u,f=r.length,l=n.length;if(e.alive)if(f>=l)for(r.slice(l).each(function(){var t=this.vmIndex;"number"==typeof t&&($.viewModel[t]=null)}).remove(),r=e.instance=r.slice(0,l),r.prevObject=null,u=0;l>u;u+=1)i.apply(t(r[u]),o.concat(n[u]));else{var h=e.template,p=N.createDocumentFragment();for(u=0;l>u;u+=1)f>u?s=t(r[u]):(s=h.clone(),C(r,p.appendChild(s[0]))),i.apply(s,o.concat(n[u]));if(p.childNodes.length)if(!f&&e.parent)e.parent.appendChild(p);else{var v,d=r[f-1];(v=d.nextSibling)?d.parentNode.insertBefore(p,v):d.parentNode.appendChild(p)}h=p=null}else{var _=Math.min(f,l);for(u=0;_>u;u+=1)i.apply(t(r[u]),o.concat(n[u]))}}else i.apply(r,o.concat(n));else{if(!b(n))return;i=n,o=this.dataModel[e.method],i.apply(r,[].concat(o))}}}},t.fn.refresh=function(t){var e=this,n=this[0];return y(t)?new p(t,this.scanView(),n).refresh():w(t)&&o(t,function(t,r){var i=e.eq(r);i.length&&new p(t,i.scanView(),n).refresh()}),this},s(t.fn,{render:function(e){function n(t,e){var n=i[e];b(n)&&n[w(t)?"apply":"call"](r,t)}var r=this,i=t.fn;return y(e)?o(e,n):w(e)&&o(e,function(t){y(t)&&o(t,n)}),this},listen:function(e){var n=this;return n.refresh(e),t.observe(e,function(t,e){var r={};r[e]=t,n.refresh(r)})}}),t.define=function(e,r){var i,o=t(e);return o.length?(i={},i=r(i)||i,o.listen(i)):n},t.render=function(e){return t("[render]").each(function(){var n,r=t(this),i=r.attr("render");i in e&&y(n=e[i])&&r.render(n)}),this};var D={vmodel:{},ready:function(e){var n=this;return t(document).ready(function(){e.call(n.$scan())}),this},$scan:function(){var e=this;return t("[app]").each(function(){var n=t(this),r=n.attr("app"),i=!1;e.vmodel[r]=n.scanView(),e.on(r+".module",function(t,e){!i&&y(t)&&(i=!0,this[e]=n.listen(t),i=!1)})}),this}};t.module=t.observe(D)}});