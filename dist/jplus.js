/* jplus 2014-09-19 */
(function(t,n,r){"use strict";function e(t){return a(i(t))}function i(t){var n=h(t).match(m);return l(n,function(t,r){var e=n[t]=h(r).match(y);e[0]=h(e[0]),e[1]&&(e[1]=h(e[1])),-1!==e[0].indexOf("-")&&(e[0]=h(e[0]).match(b))})}function a(n){var r={};return l(n,function(){var n=this;switch(!0){case 1===n.length:r[n[0]]={};break;case p(n[0]):r[n[1]]={method:n[0][0],args:n[0].slice(1)};break;case n[0]in t.fn:r[n[1]]={method:n[0],args:[]};break;default:r[n[0]]={method:d}}}),r}function c(t){return new c.init(t)}function o(t,n){if(!n(t))for(t=t.firstChild;t;)o(t,n),t=t.nextSibling}function s(){var n=g(t.fn);return n.length=0,n}function f(n){if(!t.isArray(n))return!1;var r,e,i=n.length;if(i>1){for(r=t.type(n[0]),e=i-1;e>=0;e--)if(t.type(n[e])!==r)return!1;return!0}return!1}var u=[];u.push,u.slice,u.splice;var h=t.trim,l=t.each,v=t.extend,p=t.isArray,d=(t.isObject,t.isFunction,t.noop);t.data;var g=Object.create||function(t){var n=function(){};return n.prototype=t,new n},m=/[^;]+/g,y=/[^:]+/g,b=/[^-]+/g;c.init=function(t){this[0]=t},c.init.prototype=c.prototype={collect:function(){var t=this;return o(this[0],function(n){return t.getAttr(n)}),this},clean:function(t){var n,r;for(r in this)this.hasOwnProperty(r)&&(n=this[r],n.removeAttr&&n.removeAttr("js"),t&&delete this[r]);return this},getAttr:function(n){if(!/text/.test(n.nodeName)){var i=this,a=t(n),c=a.attr("noscan"),o=a.attr("js");return o&&l(e(o),function(t){var r=i[t];r||(r=i[t]=s(),v(r,this)),r[r.length++]=n}),c!==r?!0:r}}},t.fn.scan=function(t){var n;return(t||!(n=this.data("vmodel")))&&(n=this.data("vmodel",c(this[0]).collect()).data("vmodel")),n},t.fn.refresh=function(n){var r=this,e=r.scan();l(n,function(n,r){if(n in e){var i,a=e[n],c=a.method,o=a.args,s=c in t.fn,h=p(r);switch(h&&(i=f(r)),!0){case s&&h&&i:l(a,function(n){t.fn[c].apply(t(this),o.concat(r[n]))});break;case s:t.fn[c].apply(a,o.concat(r));break;default:c=r,o=c.args||u,o=p(o)?o:[o],i=f(o),l(a,function(n){c.apply(t(this),i?o[n]:o)})}}})}})(jQuery||Zepto,this);