/* jplus 2014-12-21 */
(function(t){var e;try{if(define.amd?e=requirejs.s.contexts._.config.paths:define.cmd&&(e=seajs.data.alias),"jquery"in e)define(function(e){var n=e("jquery");return t(n,window),n});else{if(!("zepto"in e))throw Error("No jQuery and Zepto");define(function(e){var n=e("zepto");return t(n,window),n})}}catch(n){t(window.jQuery||window.Zepto||window,window)}})(function(t,e){function n(t){return function(){return Function.prototype.call.apply(t,arguments)}}function r(t){return function(e){return null==e?e:p(e)==="[object "+t+"]"}}function i(t,n,r){if(void 0==t||!m(n))return t;var i,o=t.length,s=0;if(o===+o&&o>0){for(;o>s;s+=1)if(i=n.call(r||e,t[s],s),void 0!==i)return i;return t}var a,u=j.keys(t);for(o=u.length;o>s;s+=1)if(a=u[s],i=n.call(r||e,t[a],a),void 0!==i)return i;return t}function o(){var t,e=arguments[0];if("boolean"==typeof e&&(t=e,e=arguments[1]),"object"!=typeof e&&!m(e))return e;var n=_(arguments,t?2:1);return i(n,function(n){"object"==typeof n&&i(n,function(n,r){if(t&&"object"==typeof n){var i=e[r];return e[r]="object"==typeof i?i:{},o(t,e[r],n)}e[r]=n})}),e}function s(t){if(!b(t))return!1;var e,n,r=t.length;if(r>1)for(e=p(t[0]),n=r-1;n>0;n--)if(p(t[n])!==e)return!1;return!0}function a(t){return t+Math.random().toString(36).substr(2)}function u(t){return setTimeout(t,0)}function f(t){var e;return y(t)?e=o(!0,{},t):b(t)?(e=[],i(t,function(t,n){e[n]=f(t)})):e=t,e}function c(t){if(!I.ES5&&t in S)throw Error("If you want to support IE6/7/8. The property name [ "+t+" ] can not be observed, "+"because DOM has the same property name. "+"You can use the [observe.ES5 = true] to ignore IE6/7/8.")}function h(t){this.$startNode=t,this.viewModel={}}function l(t,e,n){this.dataModel=t,this.viewModel=e,this.startNode=n}var v=Object.prototype,p=n(v.toString),d=n(v.hasOwnProperty),_=n(Array.prototype.slice),y=r("Object"),g=r("String"),m=r("Function"),b=Array.isArray||r("Array");if(!String.prototype.trim){var w=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(w,"")}}var j={keys:Object.keys||function(t){var e=[];if(!y(t))return e;for(var n in t)d(t,n)&&e.push(n);return e},parse:function(t){var e={};if(!g(t))return e;var n=t.trim().split(";");return i(n,function(t){return t=t.trim().split(":"),2>t.length?e[t[0].trim()]="":(e[t[1].trim()]=t[0].trim(),void 0)}),e}},O=Object.create||function(t){var e=function(){};return e.prototype=t,new e};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=this.length-1;e>=0;e--)if(this[e]===t)return e;return-1});var x=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var i=p(t);if(i!==p(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(m(s)&&s instanceof s&&m(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;n.push(t),r.push(e);var f,c;if(o){if(f=t.length,c=f===e.length)for(;f--&&(c=x(t[f],e[f],n,r)););}else{var h,l=j.keys(t);if(f=l.length,c=j.keys(e).length===f)for(;f--&&(h=l[f],c=d(e,h)&&x(t[h],e[h],n,r)););}return n.pop(),r.pop(),c};j.isEqual=function(t,e){return x(t,e,[],[])};var E,M,A=document,N=A.getElementsByTagName("head")[0],S=A.createComment("Kill IE6/7/8"),F=/\[native code\]/;F.test(Object.defineProperty)&&F.test(Object.create)?M=Object.defineProperty:F.test(Object.prototype.__defineSetter__)&&(M=function(t,e,n){t.__defineGetter__(e,n.get),t.__defineSetter__(e,n.set)});var q;M?(E=!0,q=function(t,e){function n(){i(t.__events__[e],function(n){i(n,function(n){n.call(t,o,e,s)})}),s=f(o),r=!1}if(!(e in t.__events__)){var r,o=t[e],s=f(o);M(t,e,{get:function(){return o},set:function(t){o=t,r||j.isEqual(t,s)||(r=!0,u(n))}})}}):"onpropertychange"in N&&(q=function(t){function e(e,o){var s=n[e],a=t[e];j.isEqual(a,s)||(i(o,function(n){i(n,function(n){n.call(t,a,e,s)})}),n[e]=f(a),r[e]=!1)}if(!t.onpropertychange){var n={},r={};t.each(function(t,e){n[e]=f(t)}),t.onpropertychange=function(t){var n=(t||window.event).propertyName,i=this.__events__;if(n in i){if(r[n])return;r[n]=!0,u(function(){e(n,i[n])})}}}});var k={_add:function(t,e,n){c(t),q(this,t),n=n||a("observer");var r=this.__events__[t]=this.__events__[t]||{};return r[n]=r[n]||[],r[n].push(e),this},on:function(){var t,e=this,n=_(arguments),r=n.length;if(1===r)y(t=n[0])?i(t,function(t,n){e.on(n,t)}):m(t)&&this.each(function(n,r){e._add(r,t,"__all__")});else if(2===r){if(!m(n[1]))return this;if(g(t=n[0])){var o=t.indexOf(".");0>=o?this._add(t,n[1]):this._add(t.substr(0,o),n[1],t.substr(o+1))}else b(t)&&i(t,function(t){e.on(t,n[1])})}return this},_bang:function(t,e,n){var r=this,o=r[t];i(this.__events__[t][n],function(n){n.call(r,e,t,o)})},trigger:function(t,e){var n,r=this;return t?(g(t)?(n=t.indexOf("."),n>0?this._bang(t.substr(0,n),e,t.substr(n+1)):n?i(this.__events__[t]||[],function(n,i){r._bang(t,e,i)}):(t=t.substr(1),i(this.__events__,function(n,o){i(n,function(n,i){i===t&&r._bang(o,e,i)})}))):b(t)&&i(t,function(t){r.trigger(t,e)}),this):this},_remove:function(t,e,n){var r=this.__events__[t][n]||[],i=r.indexOf(e);return-1!==i&&r.splice(i,1),this},off:function(){var t,e,n=this,r=_(arguments),o=r.length;if(o){if(1===o)m(t=r[0])?i(this.__events__,function(e,r){i(e,function(e,i){n._remove(r,t,i)})}):g(t)&&(e=t.indexOf("."),0>=e?this.__events__[t]={}:delete this.__events__[t.substr(0,e)][t.substr(e+1)]);else if(2===o){if(!m(r[1]))return this.off(r[0]),this;g(t=r[0])?(e=t.indexOf("."),0>=e?i(this.__events__[t],function(e,i){n._remove(t,r[1],i)}):this._remove(t.substr(0,e),r[1],t.substr(e+1))):b(t)&&i(t,function(t){n.off(t,r[1])})}}else this.__events__={};return this},offAll:function(){var t=this;return i(this.__events__,function(e,n){t.off([n,"__all__"].join("."))}),this},each:function(t){var e=this;if(this.nodeName)for(var n in this)-1!==e.filter.indexOf(n)||n in S||t.call(e,this[n],n);else i(this,function(n,r){-1===e.filter.indexOf(r)&&t.call(e,n,r)});return this},extend:function(){return o.apply(e,[this].concat(_(arguments)))},once:function(t,e){function n(){e.apply(r,arguments),r.off(n)}var r=this;return t+=".once",this.on(t,n)},tie:function(t,e){if(!m(e))return this;if(b(t)){var n=this,r=t.length,o=[],s=[],a=function(a,u){0>o.indexOf(u)?(o.push(u),o.length===r&&(i(t,function(t,e){t=t.split(".")[0],s[e]=n[t]}),e.apply(n,s))):o.length>=r&&(o.length=0,o.push(u))};return this.on(t,a)}return g(t)?(t=t.split(" "),t.length>1?this.tie(t,e):this.on(t[0],e)):this},collect:function(t,e,n){function r(t){o.push(t),o.length===e&&(n.apply(i,o),i.off(r))}var i=this,o=[];return this.on(t,r)}};k.bind=k.on,k.unbind=k.off,k.fire=k.trigger,k.filter=j.keys(k).concat(["__events__","filter"]);var I=E?function(t,e){if(!y(t))return{};var n=o(O(k),t,{__events__:{}});return y(e)||m(e)?n.on(e):n}:function(t,e){if(!y(t))return{};var n=o(N.appendChild(A.createComment("[object Object]")),k,t,{__events__:{}});return y(e)||m(e)?n.on(e):n};if(I.ES5=!1,I.fn=k,t.observe=I,t!==e){var V=t.plus={attr:"js",filterAttr:["noscan","app"],viewModel:[]},$=n(Array.prototype.push);h.prototype={filter:function(e){var n=[],r=this.$startNode[0],o=r.id=r.id||"filter_id_for_scaner";return i(V.filterAttr,function(e){var r=t([o,"["+e+"]","["+V.attr+"]"].join(" "));n.push.apply(n,_(r))}),"filter_id_for_scaner"===o&&(r.removeAttribute?r.removeAttribute("id"):r.id=""),e.filter(function(){return-1===n.indexOf(this)})},parse:function(t){var e=this.viewModel;return i(j.parse(t.attr(V.attr)),function(n,r){var i=e[r]=e[r]||{};i.instance?$(i.instance,t[0]):(n=n.split("-"),i.method=n[0],i.params=n.slice(1),i.instance=t,i.lastValue=null,i.alive=void 0!==t.attr("unalive")?!1:!0,i.template=t.clone(),i.parent=t[0].parentNode)}),this},scan:function(){var e=this;return this.parse(this.$startNode).filter(this.$startNode.find("["+V.attr+"]")).each(function(){var n=t(this);n.prevObject=n.context=null,e.parse(n)}),this},rescan:function(){return this.viewModel={},this.scan()},get:function(){return this.viewModel}},t.fn.scanView=function(t){var e=this[0],n=e.vmIndex;if("number"==typeof n&&!t)return V.viewModel[n].get();var r=V.viewModel[e.vmIndex||(e.vmIndex=V.viewModel.length)]=new h(this);return r.scan().get()};var C=t.fn;l.prototype={refresh:function(){for(var t,e,n=this.viewModel,r=this.dataModel,i=j.keys(n),o=0,s=i.length;s>o;o+=1)e=i[o],t=r[e],void 0!==t&&this.render(n[e],t)},render:function(e,n){if(!j.isEqual(n,e.lastValue)){e.lastValue=f(n);var r=e.instance,i=C[e.method],o=e.params;if("function"==typeof i)if(s(n)){var a,u,c=r.length,h=n.length;if(e.alive)if(c>=h)for(r.slice(h).remove(),e.instance=r.slice(0,h),u=0;h>u;u+=1)i.apply(t(r[u]),o.concat(n[u]));else{var l=e.template,v=A.createDocumentFragment();for(u=0;h>u;u+=1)c>u?a=t(r[u]):(a=l.clone(),$(r,v.appendChild(a[0]))),i.apply(a,o.concat(n[u]));if(v.childNodes.length)if(c){var p,d=r[c-1];(p=d.nextSibling)?d.parentNode.insertBefore(v,p):d.parentNode.appendChild(v)}else e.parent.appendChild(v);l=v=null}else{var _=Math.min(c,h);for(u=0;_>u;u+=1)i.apply(t(r[u]),o.concat(n[u]))}}else i.apply(r,o.concat(n));else{if(!m(n))return;i=n,o=this.dataModel[e.method],i.apply(r,[].concat(o))}}}},t.fn.refresh=function(t){var e=this,n=this[0];return y(t)?new l(t,this.scanView(),n).refresh():b(t)&&i(t,function(t,r){var i=e.eq(r);i.length&&new l(t,i.scanView(),n).refresh()}),this},o(t.fn,{render:function(e){function n(t,e){var n=o[e];m(n)&&n[b(t)?"apply":"call"](r,t)}var r=this,o=t.fn;return y(e)?i(e,n):b(e)&&i(e,function(t){y(t)&&i(t,n)}),this},listen:function(e){var n=this;return n.refresh(e),t.observe(e,function(t,e){var r={};r[e]=t,n.refresh(r)})}}),t.define=function(e,n){var r,i=t(e);return i.length?(r={},r=n(r)||r,i.listen(r)):void 0},t.render=function(e){return t("[render]").each(function(){var n,r=t(this),i=r.attr("render");i in e&&y(n=e[i])&&r.render(n)}),this};var B={vmodel:{},ready:function(e){var n=this;return t(document).ready(function(){e.call(n.$scan())}),this},$scan:function(){var e=this;return t("[app]").each(function(){var n=t(this),r=n.attr("app"),i=!1;e.vmodel[r]=n.scanView(),e.on(r+".module",function(t,e){!i&&y(t)&&(i=!0,this[e]=n.listen(t),i=!1)})}),this}};t.module=t.observe(B)}});