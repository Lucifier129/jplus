/* jplus 2014-10-06 */
(function(t){"use strict";var e=document.getElementsByTagName("body")[0].style,n=["","-webkit-","-moz-","-ms-","-o-"],r=n.length,i=t.camelCase;t.css3fix=function(t){for(var o,a=0;r>a;a+=1)if(o=i(n[a]+t),o in e)return o;return!1};var o="ontouchstart"in document,a=o?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},s=function(t){return s="touches"in t?function(t){var e=t.touches[0];return{x:e.clientX,y:e.clientY}}:function(t){return{x:t.clientX,y:t.clientY}},s(t)},c=document.addEventListener?function(t,e,n){t.addEventListener(e,n,!1)}:function(t,e,n){t.attachEvent("on"+e,n)},u=document.removeEventListener?function(t,e,n){t.removeEventListener(e,n)}:function(t,e,n){t.detachEvent("on"+e,n)},l=function(t,e){var n={start:{},move:{}},r={start:function(t){"preventDefault"in(t=t||window.event)?t.preventDefault():t.returnValue=!1;var i=s(t);n.start.x=n.move.x=i.x,n.start.y=n.move.y=i.y,n.start.timeStamp=+new Date,n.start.begin=!0,n.start.dir=function(t,e){var r=Math.atan2(Math.abs(t),Math.abs(e))*(180/Math.PI);return n.start.dir=function(){return r},r},"start"in e&&e.start.call(this,t,n.start),f(function(){c(document,a.move,r.move),c(document,a.end,r.end)})},move:function(r){"preventDefault"in(r=r||window.event)?r.preventDefault():r.returnValue=!1;var i=s(r);n.move.dir=n.start.dir(i.y-n.start.y,i.x-n.start.x),n.move.x=i.x-n.move.x,n.move.y=i.y-n.move.y,"move"in e&&e.move.call(t,r,n.move),n.move.x=i.x,n.move.y=i.y},end:function(i){if("preventDefault"in(i=i||window.event)?i.preventDefault():i.returnValue=!1,u(document,a.move,r.move),u(document,a.end,r.end),n.start.begin=!1,n.end={x:n.move.x-n.start.x,y:n.move.y-n.start.y,t:+new Date-n.start.timeStamp,dir:{},stop:!1},220>n.end.t&&Math.max(Math.abs(n.end.x),Math.abs(n.end.y))>10){n.move.dir>30?n.end.dir[n.end.y>0?"down":"up"]=1:n.end.dir[n.end.x>0?"right":"left"]=1;for(var s in n.end.dir)s in e&&(n.end.stop=!0,e[s].call(t,i,n.end))}else if(200>n.end.t&&10>Math.max(Math.abs(n.end.x),Math.abs(n.end.y))){if("tap"in e){if(o){var c=i.target;"A"===c.nodeName?setTimeout(function(){c.click()},0):"A"===c.parentNode.nodeName&&setTimeout(function(){c.parentNode.click()},0)}e.tap.call(t,i,n)}}else!n.end.stop&&"end"in e&&e.end.call(t,i,n.end,n.move)}};c(t,a.start,r.start)},f="function"==typeof window.setImmediate?function(t){window.setImmediate(t)}:function(t){window.setTimeout(t,0)};t.fn.swipe=function(t){return this.each(function(){l(this,t)})};var d,h,p=t.css3fix("transform"),m=t.css3fix("transition");p&&m?(d={setX:function(t,e){t.style[p]="translateX("+e+"px)"},setY:function(t,e){t.style[p]="translateY("+e+"px)"},animateX:function(e,n,r){t(e).addClass("transi-for-swipeshow"),d.setX(e,n),setTimeout(r,400)},animateY:function(e,n,r){t(e).addClass("transi-for-swipeshow"),d.setY(e,n),setTimeout(r,400)}},h=document.createElement("style"),h.type="text/css",h.innerHTML=".transi-for-swipeshow { -webkit-transition: all .4s ease-out; -moz-transition: all .4s ease-out; transition: all .4s ease-out;}",document.getElementsByTagName("head")[0].appendChild(h)):d={setX:function(t,e){t.style.marginLeft=e+"px"},setY:function(t,e){t.style.marginTop=e+"px"},animateX:function(e,n,r){t(e).animate({marginLeft:n},400,r)},animateY:function(e,n,r){t(e).animate({marginTop:n},400,r)}},t.fn.swipeshow=function(e){var n={dir:"x",className:"cur",speed:3e3,auto:!0,type:"click"};t.extend(n,e),n.dir=n.dir.toUpperCase();var r,i,o=this,a=d["set"+n.dir],s=d["animate"+n.dir],c=o.parent(),u=o.children(),l=u.length,f=c.width(),h=c.height(),p=c.css("position"),v=/x/i.test(n.dir),_=[],y=!0;if(1>=l)return this;2===l&&(u.each(function(){o.append(t(this).clone(!0))}),u=o.children(),l=4,i=!0),u.each(function(){_.push(t(this))}),r=v?f:h,e=n.opts?t(n.opts).children():null,c.css({position:/absolute|fixed|relative/.test(p)?c.css("position"):"relative",overflow:"hidden"}),u.css({"float":"left",width:f,height:h}),o.css({position:"absolute",top:0,left:0,width:v?f*l:f,height:v?h:h*l}).on("click","a",function(t){y?t.preventDefault():y=!0});var g,x,b=0,w=0,k=0,V=o[0],M=!0,C=null,T={check:function(t){var e=t-b;return t>b?(k-=e,k=0>k?k+l:k):b>t&&(k=(k-e)%l),b=t,w=b*r,this},callback:function(){var t=!1;0===b?(b=-1,o.children().last().prependTo(o),t=!0):b===1-l&&(b=2-l,o.children().first().appendTo(o),t=!0),t&&(w=b*r,a(m?o.removeClass("transi-for-swipeshow")[0]:V,w)),M=!0},slide:function(){return M=!1,s(V,w,this.callback),e&&(i?e.removeClass(n.className).eq(k%2).add(e.eq(k)).addClass(n.className):e.eq(k).addClass(n.className).siblings().removeClass(n.className)),this},normal:function(){M&&(T.check(Math.round(w/r)).slide(),n.callback&&n.callback.call(o,i?k%2:k))},next:function(){return M?(T.check(b-1).slide(),n.callback&&n.callback.call(o,i?k%2:k),this):this},prev:function(){M&&(T.check(b+1).slide(),n.callback&&n.callback.call(o,i?k%2:k))}}.check(0).slide();return o.swipe({tap:function(){y=!1,T.normal()},start:function(){M&&o.removeClass("transi-for-swipeshow")},move:function(t,e){M&&(w+=e[n.dir.toLowerCase()],a(V,w))},end:T.normal,up:v?T.normal:T.next,down:v?T.normal:T.prev,left:v?T.next:T.normal,right:v?T.prev:T.normal}),e&&n.type&&(x=e.parent().on(n.type,e.get(0).nodeName.toLowerCase(),function(){M&&T.check(-_[t(this).index()].index()).slide()})),n.auto&&(g=function(t){t.preventDefault(),"mouseenter"===t.type?clearTimeout(C):T.loop()},T.loop=function(){C=setTimeout(function(){T.next().loop()},n.speed)},c.on("mouseenter mouseleave",g).data("hover",!0),x&&!x.parent().data("hover")&&x.on("mouseenter mouseleave",g),T.loop()),n.next&&(n.next=t(n.next),n.next.on("click",T.next),g&&n.next.parent().data("hover")||n.next.on("mouseenter mouseleave",g)),n.prev&&(n.prev=t(n.prev),n.prev.on("click",T.prev),g&&n.prev.parent().data("hover")||n.prev.on("mouseenter mouseleave",g)),this}})(jQuery||Zepto);