/* jplus 2014-12-03 */
!function(t,e){function n(t){return function(){return Function.prototype.call.apply(t,arguments)}}function r(t){return function(e){return null==e?e:y(e)==="[object "+t+"]"}}function i(n,r,i,o){if(n==e||!w(r))return n;var s,u=n.length;if(u===+u&&u>0&&!o){for(var a=0;u>a;a+=1)if(s=r.call(i||t,n[a],a,n),s!==e)return s;return n}for(var f in n)if(m(n,f)&&(s=r.call(i||t,n[f],f,n),s!==e))return s;return n}function o(){var t,e=arguments[0];if("boolean"==typeof e&&(t=e,e=arguments[1]),"object"!=typeof e&&!w(e))return e;var n=b(arguments,t?2:1);return i(n,function(n){"object"==typeof n&&i(n,function(n,r){if(t&&"object"==typeof n){var i=e[r];return e[r]="object"==typeof i?i:{},o(t,e[r],n)}e[r]=n})}),e}function s(t){if(!O(t))return!1;var e,n,r=t.length;if(r>1){for(e=y(t[0]),n=r-1;n>=0;n--)if(y(t[n])!==e)return!1;return!0}return!1}function u(e,n,r){return e[O(n)?"apply":"call"](r||t,n)}function a(t){var e;return w(t)?(e=E(t.prototype),e=t.apply(e,b(arguments,1))||e):e="object"==typeof t?t:{},e}function f(n){var r=f.instance,a=f.alias,c={};return i(n,function(t,n){var f,h=r[n];h===e&&n in a&&(h=r[n=a[n]]),w(h)?s(t)?(c[n]=[],i(t,function(t){f=u(h,t,r),f!==e&&c[n].push(f)})):(f=u(h,t,r),f!==e&&(c[n]=f)):"object"==typeof h&&"object"==typeof t?o(h,t):r[n]=t},t,!0),c}function c(){var n=a.apply(t,arguments),r=E(c.alias);return o(function(t){if(t===e)return n;var o;return f.instance=n,f.alias=r,O(t)?(o=[],i(t,function(t){"object"==typeof t&&o.push(f(t))})):"object"==typeof t&&(o=f(t)),o},{alias:r})}function h(t){throw Error(t)}function l(t){return t+Math.random().toString(36).substr(2)}function p(t){if(!P.ES5&&t in F)throw Error("If you want to support IE6/7/8. The property name ["+t+"] can not be observed, "+"because DOM has the same property name. "+"You can use the [jQuery.ES5 = true] to ignore IE6/7/8.")}function v(t){this.$startNode=t,this.viewModel={}}function _(t,e){this.dataModel=t,this.viewModel=e}var d=Object.prototype,y=n(d.toString),m=n(d.hasOwnProperty),b=n(Array.prototype.slice),g=r("Object"),j=r("String"),w=r("Function"),O=Array.isArray||r("Array");if(!String.prototype.trim){var x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(x,"")}}var A={keys:Object.keys||function(t){if(!g(t))return[];var e=[];for(var n in t)m(t,n)&&e.push(n);return e},values:function(t){for(var e=this.keys(t),n=e.length,r=Array(n),i=0;n>i;i+=1)r[i]=t[e[i]];return r},invert:function(t){for(var e={},n=this.keys(t),r=0,i=n.len;i>r;r++)e[t[n[r]]]=n[r];return e},parse:function(t){if(!j(t))return{};var e={},n=t.trim().split(";");return i(n,function(t){t=t.trim().split(":"),2>t.length||(e[t[1].trim()]=t[0].trim())}),e}},E=Object.create||function(t){var e=function(){};return e.prototype=t,new e};c.alias=E({extend:function(t){return o(this,t)},each:function(t){return i(this,t)},keys:function(){return A.keys(this)},values:function(){return A.values(this)},invert:function(){return A.invert(this)},parse:function(t){return this.extend(A.parse(t))}});var M=function(t){return setTimeout(t,0)},S=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var i=y(t);if(i!==y(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,u=e.constructor;if(s!==u&&!(w(s)&&s instanceof s&&w(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}for(var a=n.length;a--;)if(n[a]===t)return r[a]===e;n.push(t),r.push(e);var f,c;if(o){if(f=t.length,c=f===e.length)for(;f--&&(c=S(t[f],e[f],n,r)););}else{var h,l=A.keys(t);if(f=l.length,c=A.keys(e).length===f)for(;f--&&(h=l[f],c=m(e,h)&&S(t[h],e[h],n,r)););}return n.pop(),r.pop(),c};A.isEqual=function(t,e){return S(t,e,[],[])};var $,k=document,q=k.getElementsByTagName("head")[0],F=k.createComment("Kill IE6/7/8"),N=/\[native code\]/;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=this.length-1;e>=0;e--)if(this[e]===t)return e;return-1});var V;N.test(Object.defineProperty)&&N.test(Object.create)?V=Object.defineProperty:N.test(Object.prototype.__defineSetter__)&&(V=function(t,e,n){t.__defineGetter__(e,n.get),t.__defineSetter__(e,n.set)});var I;V?($=!0,I=function(t,e){function n(){i(t.__events__[e],function(n){i(n,function(n){n.call(t,s,e,u)})}),u="object"==typeof s?O(s)?s.concat():o(!0,{},s):s,r=!1}if(!(e in t.__events__)){var r,s=t[e],u="object"==typeof s?O(s)?s.concat():o(!0,{},s):s;V(t,e,{get:function(){return s},set:function(t){s=t,r||A.isEqual(t,u)||(r=!0,M(n))}})}}):"onpropertychange"in q&&(I=function(t){function e(e,s){var u=n[e],a=t[e];A.isEqual(a,u)||(i(s,function(n){i(n,function(n){n.call(t,a,e,u)})}),n[e]="object"==typeof a?O(a)?a.concat():o(!0,{},a):a,r[e]=!1)}if(!t.onpropertychange){var n={},r={};t.each(function(t,e){n[e]=g(t)?o(!0,{},t):O(t)?t.concat():t}),t.onpropertychange=function(t){t=t||window.event;var n=t.propertyName,i=this.__events__;if(n in i){if(r[n])return;r[n]=!0,M(function(){e(n,i[n])})}}}});var C={filter:"__events__ _add _remove on off offAll each extend once hold filter".split(" "),_add:function(t,e,n){return p(t),I(this,t),n=n||l("observer"),this.__events__[t]=this.__events__[t]||{},this.__events__[t][n]=this.__events__[t][n]||[],this.__events__[t][n].push(e),this},on:function(){var t,e=this,n=b(arguments),r=n.length;if(1===r)g(t=n[0])?i(t,function(t,n){e.on(n,t)}):w(t)&&this.each(function(n,r){e._add(r,t,"__all__")});else if(2===r){if(!w(n[1]))return this;if(j(t=n[0])){var o=t.indexOf(".");0>=o?this._add(t,n[1]):this._add(t.substr(0,o),n[1],t.substr(o+1))}else O(t)&&i(t,function(n){e.on(n,t[1])})}return this},_remove:function(t,e,n){var r=this.__events__[t][n]||[],i=r.indexOf(e);return-1!==i&&r.splice(i,1),this},off:function(){var t,e,n=this,r=b(arguments),o=r.length;if(o){if(1===o)w(t=r[0])?i(this.__events__,function(e,r){i(e,function(e,i){n._remove(r,t,i)})}):j(t)&&(e=t.indexOf("."),0>=e?this.__events__[t]={}:delete this.__events__[t.substr(0,e)][t.substr(e+1)]);else if(2===o){if(!w(r[1]))return this.off(r[0]),this;j(t=r[0])?(e=t.indexOf("."),0>=e?i(this.__events__[t],function(e,i){n._remove(t,r[1],i)}):this._remove(t.substr(0,e),r[1],t.substr(e+1))):O(t)&&i(t,function(t){n.off(t,r[1])})}}else this.__events__={};return this},offAll:function(){var t=this;return i(this.__events__,function(e,n){t.off([n,"__all__"].join("."))}),this},each:function(t){var e=this;if(this.nodeName)for(var n in this)-1!==e.filter.indexOf(n)||n in F||t.call(e,this[n],n);else i(this,function(n,r){-1===e.filter.indexOf(r)&&t.call(e,n,r)});return this},extend:function(){return o.apply(t,[this].concat(b(arguments)))},once:function(t,e){function n(){e.apply(r,arguments),r.off(t)}var r=this;return t+=".once",this.on(t,n)},hold:function(t,e,n){function r(){e--,0>=e&&n.apply(i,arguments)}e===+e&&e>=0||h(e+"不是一个正整数");var i=this;return this.on(t,r),this}},P=$?function(t,e){if(!g(t))return{};var n=o(E(C),t,{__events__:{}});return g(e)||w(e)?n.on(e):n}:function(t,e){if(!g(t))return{};var n=o(q.appendChild(k.createComment("[object Object]")),C,t,{__events__:{}});return g(e)||w(e)?n.on(e):n};P.ES5=!1;var T=window.jQuery||window.Zepto;if(T===e)return w(t.define)&&(define.amd||define.cmd)?define({agent:c,observe:P}):(t.agent=c,t.observe=P,t.$$===e&&(t.$$=c)),e;T.agent=c,T.observe=P;var B=T.plus={attr:"js",filterAttr:["noscan","app"],viewModel:[]},D=n(Array.prototype.push);v.prototype={filter:function(t){var e=[],n=this.$startNode;return i(B.filterAttr,function(t){e.push.apply(e,b(n.find("["+t+"]"+" ["+B.attr+"]")))}),t.filter(function(){return-1===T.inArray(this,e)})},parse:function(t){var e=this.viewModel;return i(A.parse(t.attr(B.attr)),function(n,r){var i=e[r]=e[r]||{};i.instance?D(i.instance,t[0]):(n=n.split("-"),i.method=n[0],i.params=n[1]?[n[1]]:[],i.instance=t,i.lastValue=null)}),this},scan:function(){var t=this;return this.parse(this.$startNode).filter(this.$startNode.find("["+B.attr+"]")).each(function(){t.parse(T(this))}),this},rescan:function(){return this.viewModel={},this.scan()},get:function(){return this.viewModel}},T.fn.scanView=function(t){var e,n=this[0],r=n.vmIndex,i="number"==typeof r;return i?(e=B.viewModel[r],t?e.rescan().get():e.get()):(e=new v(this),B.viewModel[n.vmIndex=B.viewModel.length]=e,e.scan().get())};var Q=T.fn;_.prototype={refresh:function(){var t=this,e=this.viewModel;i(this.dataModel,function(n,r){r in e&&t.render(e[r],n)})},render:function(t,e){if(!A.isEqual(e,t.lastValue)){t.lastValue="object"==typeof e?O(e)?e.concat():o(!0,{},e):e;var n=t.instance,r=t.method,u=t.params,a=t.method in Q;if(a)if(s(e)){var f=n.eq(0).clone(),c=[];r=Q[r],i(e,function(t,e){var i=n.eq(e);i.length||(i=f.clone(),c.push(i.get(0))),r.apply(i,u.concat(t))}),c.length&&(n.eq(-1).after(c),c.push.apply(n,c))}else Q[r].apply(n,u.concat(e));else{if(!w(e))return;r=e,u=this.dataModel[t.method],r.apply(n,[].concat(u||[]))}}}},T.fn.refresh=function(t){var e=this;return g(t)?new _(t,this.scanView()).refresh():O(t)&&i(t,function(t,n){new _(t,e.eq(n).scanView()).refresh()}),this},o(T.fn,{render:function(t){function e(t,e){var i=r[e];w(i)&&i[O(t)?"apply":"call"](n,t)}var n=this,r=T.fn;return g(t)?i(t,e):O(t)&&i(t,function(t){g(t)&&i(t,e)}),this},listen:function(t){var e=this;return e.refresh(t),T.observe(t,function(t,n){var r={};r[n]=t,e.refresh(r)})}}),T.define=function(t,n){var r,i=T(t);return i.length?(r={},r=n(r)||r,i.listen(r)):e},T.render=function(t){return T("[render]").each(function(){var e,n=T(this),r=n.attr("render");r in t&&g(e=t[r])&&n.render(e)}),this};var G={vmodel:{},ready:function(t){var e=this;return T(document).ready(function(){t.call(e.$scan())}),this},$scan:function(){var t=this;return T("[app]").each(function(){var e=T(this),n=e.attr("app"),r=!1;t.vmodel[n]=e.scanView(),t.on(n+".module",function(t,n){!r&&g(t)&&(r=!0,this[n]=e.listen(t),r=!1)})}),this}};T.module=T.observe(G)}(this);