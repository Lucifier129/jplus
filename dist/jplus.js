/* jplus 2014-12-08 */
!function(t,e){function n(t){return function(){return Function.prototype.call.apply(t,arguments)}}function r(t){return function(e){return null==e?e:d(e)==="[object "+t+"]"}}function i(n,r,i,o){if(n==e||!j(r))return n;var a,s=n.length;if(s===+s&&s>0&&!o){for(var u=0;s>u;u+=1)if(a=r.call(i||t,n[u],u,n),a!==e)return a;return n}for(var f in n)if(b(n,f)&&(a=r.call(i||t,n[f],f,n),a!==e))return a;return n}function o(){var t,e=arguments[0];if("boolean"==typeof e&&(t=e,e=arguments[1]),"object"!=typeof e&&!j(e))return e;var n=y(arguments,t?2:1);return i(n,function(n){"object"==typeof n&&i(n,function(n,r){if(t&&"object"==typeof n){var i=e[r];return e[r]="object"==typeof i?i:{},o(t,e[r],n)}e[r]=n})}),e}function a(t){if(!w(t))return!1;var e,n,r=t.length;if(r>1){for(e=d(t[0]),n=r-1;n>=0;n--)if(d(t[n])!==e)return!1;return!0}return!1}function s(e,n,r){return e[w(n)?"apply":"call"](r||t,n)}function u(t){var e;return j(t)?(e=A(t.prototype),e=t.apply(e,y(arguments,1))||e):e="object"==typeof t?t:{},e}function f(n){var r=f.instance,u=f.alias,c={};return i(n,function(t,n){var f,l=r[n];l===e&&n in u&&(l=r[n=u[n]]),j(l)?a(t)?(c[n]=[],i(t,function(t){f=s(l,t,r),f!==e&&c[n].push(f)})):(f=s(l,t,r),f!==e&&(c[n]=f)):"object"==typeof l&&"object"==typeof t?o(l,t):r[n]=t},t,!0),c}function c(){var n=u.apply(t,arguments),r=A(c.alias);return o(function(t){if(t===e)return n;var o;return f.instance=n,f.alias=r,w(t)?(o=[],i(t,function(t){"object"==typeof t&&o.push(f(t))})):"object"==typeof t&&(o=f(t)),o},{alias:r})}function l(t){return t+Math.random().toString(36).substr(2)}function h(t){if(!T.ES5&&t in $)throw Error("If you want to support IE6/7/8. The property name ["+t+"] can not be observed, "+"because DOM has the same property name. "+"You can use the [observe.ES5 = true] to ignore IE6/7/8.")}function p(t){this.$startNode=t,this.viewModel={}}function v(t,e,n){this.dataModel=t,this.viewModel=e,this.startNode=n}var _=Object.prototype,d=n(_.toString),b=n(_.hasOwnProperty),y=n(Array.prototype.slice),g=r("Object"),m=r("String"),j=r("Function"),w=Array.isArray||r("Array");if(!String.prototype.trim){var x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(x,"")}}var O={keys:Object.keys||function(t){if(!g(t))return[];var e=[];for(var n in t)b(t,n)&&e.push(n);return e},values:function(t){for(var e=this.keys(t),n=e.length,r=Array(n),i=0;n>i;i+=1)r[i]=t[e[i]];return r},invert:function(t){for(var e={},n=this.keys(t),r=0,i=n.len;i>r;r++)e[t[n[r]]]=n[r];return e},parse:function(t){if(!m(t))return{};var e={},n=t.trim().split(";");return i(n,function(t){t=t.trim().split(":"),2>t.length||(e[t[1].trim()]=t[0].trim())}),e}},A=Object.create||function(t){var e=function(){};return e.prototype=t,new e};c.alias=A({extend:function(t){return o(this,t)},each:function(t){return i(this,t)},keys:function(){return O.keys(this)},values:function(){return O.values(this)},invert:function(){return O.invert(this)},parse:function(t){return this.extend(O.parse(t))}});var E=function(t){return setTimeout(t,4)},M=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var i=d(t);if(i!==d(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(j(a)&&a instanceof a&&j(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;n.push(t),r.push(e);var f,c;if(o){if(f=t.length,c=f===e.length)for(;f--&&(c=M(t[f],e[f],n,r)););}else{var l,h=O.keys(t);if(f=h.length,c=O.keys(e).length===f)for(;f--&&(l=h[f],c=b(e,l)&&M(t[l],e[l],n,r)););}return n.pop(),r.pop(),c};O.isEqual=function(t,e){return M(t,e,[],[])};var N,k=document,S=k.getElementsByTagName("head")[0],$=k.createComment("Kill IE6/7/8"),F=/\[native code\]/;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=this.length-1;e>=0;e--)if(this[e]===t)return e;return-1});var C;F.test(Object.defineProperty)&&F.test(Object.create)?C=Object.defineProperty:F.test(Object.prototype.__defineSetter__)&&(C=function(t,e,n){t.__defineGetter__(e,n.get),t.__defineSetter__(e,n.set)});var I;C?(N=!0,I=function(t,e){function n(){i(t.__events__[e],function(n){i(n,function(n){n.call(t,a,e,s)})}),s="object"==typeof a?w(a)?a.concat():o(!0,{},a):a,r=!1}if(!(e in t.__events__)){var r,a=t[e],s="object"==typeof a?w(a)?a.concat():o(!0,{},a):a;C(t,e,{get:function(){return a},set:function(t){a=t,r||O.isEqual(t,s)||(r=!0,E(n))}})}}):"onpropertychange"in S&&(I=function(t){function e(e,a){var s=n[e],u=t[e];O.isEqual(u,s)||(i(a,function(n){i(n,function(n){n.call(t,u,e,s)})}),n[e]="object"==typeof u?w(u)?u.concat():o(!0,{},u):u,r[e]=!1)}if(!t.onpropertychange){var n={},r={};t.each(function(t,e){n[e]=g(t)?o(!0,{},t):w(t)?t.concat():t}),t.onpropertychange=function(t){t=t||window.event;var n=t.propertyName,i=this.__events__;if(n in i){if(r[n])return;r[n]=!0,E(function(){e(n,i[n])})}}}});var V={_add:function(t,e,n){return h(t),I(this,t),n=n||l("observer"),this.__events__[t]=this.__events__[t]||{},this.__events__[t][n]=this.__events__[t][n]||[],this.__events__[t][n].push(e),this},on:function(){var t,e=this,n=y(arguments),r=n.length;if(1===r)g(t=n[0])?i(t,function(t,n){e.on(n,t)}):j(t)&&this.each(function(n,r){e._add(r,t,"__all__")});else if(2===r){if(!j(n[1]))return this;if(m(t=n[0])){var o=t.indexOf(".");0>=o?this._add(t,n[1]):this._add(t.substr(0,o),n[1],t.substr(o+1))}else w(t)&&i(t,function(t){e.on(t,n[1])})}return this},_bang:function(t,e,n){var r=this,o=r[t];i(this.__events__[t][n]||[],function(n){n.call(r,e,t,o)})},trigger:function(t,e){var n,r=this;return t?(m(t)?(n=t.indexOf("."),n>0?this._bang(t.substr(0,n),e,t.substr(n+1)):n?i(this.__events__[t]||[],function(n,i){r._bang(t,e,i)}):(t=t.substr(1),i(this.__events__,function(n,o){i(n,function(n,i){i===t&&r._bang(o,e,i)})}))):w(t)&&i(t,function(t){r.trigger(t,e)}),this):this},_remove:function(t,e,n){var r=this.__events__[t][n]||[],i=r.indexOf(e);return-1!==i&&r.splice(i,1),this},off:function(){var t,e,n=this,r=y(arguments),o=r.length;if(o){if(1===o)j(t=r[0])?i(this.__events__,function(e,r){i(e,function(e,i){n._remove(r,t,i)})}):m(t)&&(e=t.indexOf("."),0>=e?this.__events__[t]={}:delete this.__events__[t.substr(0,e)][t.substr(e+1)]);else if(2===o){if(!j(r[1]))return this.off(r[0]),this;m(t=r[0])?(e=t.indexOf("."),0>=e?i(this.__events__[t],function(e,i){n._remove(t,r[1],i)}):this._remove(t.substr(0,e),r[1],t.substr(e+1))):w(t)&&i(t,function(t){n.off(t,r[1])})}}else this.__events__={};return this},offAll:function(){var t=this;return i(this.__events__,function(e,n){t.off([n,"__all__"].join("."))}),this},each:function(t){var e=this;if(this.nodeName)for(var n in this)-1!==e.filter.indexOf(n)||n in $||t.call(e,this[n],n);else i(this,function(n,r){-1===e.filter.indexOf(r)&&t.call(e,n,r)});return this},extend:function(){return o.apply(t,[this].concat(y(arguments)))},once:function(t,e){function n(){e.apply(r,arguments),r.off(t)}var r=this;return t+=".once",this.on(t,n)},tie:function(t,e){if(!j(e))return this;if(w(t)){var n=this,r=t.length,o=[],a=[],s=function(s,u){0>o.indexOf(u)?(o.push(u),o.length===r&&(i(t,function(t,e){t=t.split(".")[0],a[e]=n[t]}),e.apply(n,a))):o.length>=r&&(o.length=0,o.push(u))};return this.on(t,s)}return m(t)?this.on(t,e):this}};V.bind=V.on,V.unbind=V.off,V.fire=V.trigger,V.filter=O.keys(V).concat(["__events__","filter"]);var T=N?function(t,e){if(!g(t))return{};var n=o(A(V),t,{__events__:{}});return g(e)||j(e)?n.on(e):n}:function(t,e){if(!g(t))return{};var n=o(S.appendChild(k.createComment("[object Object]")),V,t,{__events__:{}});return g(e)||j(e)?n.on(e):n};T.ES5=!1,T.fn=V;var q=window.jQuery||window.Zepto;if(q===e)return j(t.define)&&(define.amd||define.cmd)?define({agent:c,observe:T}):(t.agent=c,t.observe=T,t.$$===e&&(t.$$=c)),e;q.agent=c,q.observe=T;var B=q.plus={attr:"js",filterAttr:["noscan","app"],debug:!1,viewModel:[]},D=n(Array.prototype.push);p.prototype={filter:function(t){var e=[],n=this.$startNode[0],r=n.id=n.id||"filter_id_for_scaner";return i(B.filterAttr,function(t){var n=q([r,"["+t+"]","["+B.attr+"]"].join(" "));e.push.apply(e,y(n))}),"filter_id_for_scaner"===r&&(n.removeAttribute?n.removeAttribute("id"):n.id=""),t.filter(function(){return-1===e.indexOf(this)})},parse:function(t){var n=this.viewModel;return i(O.parse(t.attr(B.attr)),function(r,i){var o=n[i]=n[i]||{};if(o.instance)D(o.instance,t[0]);else{r=r.split("-"),o.method=r[0],o.params=r.slice(1),o.lastValue=null,o.alive=t.attr("unalive")!==e?!1:!0;var a=t.attr("insert");o.insert=a!==e?a:"after";var s=q(t.attr("temp"));if(1===s.length){var u=s[0].nodeName;/script|textarea|noscript/i.test(u)?s=q(s.html()):/input|select/i.test(u)&&(s=q(s.val()))}s.length?(o.template=s,o.defaultTemplate=!1,o.instance=A(P),o.instance.length=0,o.base=t[0]):(o.template=t.clone(),o.defaultTemplate=!0,o.instance=t)}}),this},scan:function(){var t=this;return this.parse(this.$startNode).filter(this.$startNode.find("["+B.attr+"]")).each(function(){var e=q(this);e.prevObject=e.context=null,t.parse(e)}),this},rescan:function(){return this.viewModel={},this.scan()},get:function(){return this.viewModel}},q.fn.scanView=function(){var t=new p(this);if(q.plus.debug){var e=this[0];B.viewModel[e.vmIndex="number"==typeof e.vmIndex?e.vmIndex:B.viewModel.length]=t}return t.scan().get()};var P=q.fn;v.prototype={refresh:function(){var t=this.viewModel,e=this.dataModel;for(var n in e)n in t&&this.render(t[n],e[n],n)},render:function(t,e){if(!O.isEqual(e,t.lastValue)){t.lastValue="object"==typeof e?w(e)?e.concat():o(!0,{},e):e;var n=t.instance,r=t.method,i=t.params;if(t.method in P)if(r=P[r],a(e)){var s,u,f=n.length,c=e.length;if(t.alive)if(f>=c)for(n.slice(c).remove(),u=0;c>u;u+=1)s=q(n[u]),r.apply(s,i.concat(e[u]));else{var l=t.template,h=k.createDocumentFragment();for(u=0;c>u;u+=1)f>u&&t.defaultTemplate?s=q(n[u]):(s=l.clone().each(function(){h.appendChild(this)}),D(n,s)),r.apply(s,i.concat(e[u]));if(h.childNodes.length)switch(t.insert){case"after":var p,v=n[f-1];(p=v.nextSibling)?v.parentNode.insertBefore(h,p):v.parentNode.appendChild(h);break;case"before":var _=n[0];_.parentNode.insertBefore(h,_);break;case"append":t.base.appendChild(h);break;case"prepend":var d=t.base.firstChild;d?t.base.insertBefore(h,d):t.base.appendChild(h)}l=h=null}else{var b=Math.min(f,c);for(u=0;b>u;u+=1)s=q(n[u]),r.apply(s,i.concat(e[u]))}}else r.apply(n,i.concat(e));else{if(!j(e))return;r=e,i=this.dataModel[t.method],r.apply(n,[].concat(i||[]))}}}},q.fn.refresh=function(t){var e=this,n=this[0];return g(t)?new v(t,this.scanView(),n).refresh():w(t)&&i(t,function(t,r){new v(t,e.eq(r).scanView(),n).refresh()}),this},o(q.fn,{render:function(t){function e(t,e){var i=r[e];j(i)&&i[w(t)?"apply":"call"](n,t)}var n=this,r=q.fn;return g(t)?i(t,e):w(t)&&i(t,function(t){g(t)&&i(t,e)}),this},listen:function(t){var e=this;return e.refresh(t),q.observe(t,function(t,n){var r={};r[n]=t,e.refresh(r)})}}),q.define=function(t,n){var r,i=q(t);return i.length?(r={},r=n(r)||r,i.listen(r)):e},q.render=function(t){return q("[render]").each(function(){var e,n=q(this),r=n.attr("render");r in t&&g(e=t[r])&&n.render(e)}),this};var G={vmodel:{},ready:function(t){var e=this;return q(document).ready(function(){t.call(e.$scan())}),this},$scan:function(){var t=this;return q("[app]").each(function(){var e=q(this),n=e.attr("app"),r=!1;t.vmodel[n]=e.scanView(),t.on(n+".module",function(t,n){!r&&g(t)&&(r=!0,this[n]=e.listen(t),r=!1)})}),this}};q.module=q.observe(G)}(this);