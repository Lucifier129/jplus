/* jplus 2014-10-05 */
(function(t,e,n){"use strict";function r(t){return o(i(t))}function i(t){var e=v(t).match(x);return g(e,function(t,n){var r=e[t]=v(n).match(S);r[0]=v(r[0]),r[1]&&(r[1]=v(r[1])),-1!==r[0].indexOf("-")&&(r[0]=v(r[0]).match(A))})}function o(e){var n={};return g(e,function(){var e=this;switch(!0){case 1===e.length:n[e[0]]={};break;case m(e[0]):n[e[1]]={method:e[0][0],args:e[0].slice(1)};break;case e[0]in t.fn:n[e[1]]={method:e[0],args:h};break;default:n[e[0]]={method:O}}}),n}function s(t){return new s.init(t)}function a(t,e){if(!e(t))for(t=t.firstChild;t;)a(t,e),t=t.nextSibling}function u(){var e=w(t.fn);return e.length=0,e}function c(e){if(!t.isArray(e))return!1;var n,r,i=e.length;if(i>1){for(n=t.type(e[0]),r=i-1;r>=0;r--)if(t.type(e[r])!==n)return!1;return!0}return!1}function _(t){return setTimeout(t,4)}function l(){return Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)}function f(e){if(t.ES5)return!0;if(e in I)throw Error("If you want to support IE6/7/8. The property name ["+e+"] can not be observed, because DOM has the same property name. You can use the [jQuery.ES5 = true] to ignore IE6/7/8.");return!0}var h=[],d=h.push,p=h.slice;h.splice;var v=t.trim,g=t.each,y=t.extend,m=t.isArray,b=t.isPlainObject,V=t.isFunction,j=function(t){return"string"==typeof t},O=t.noop;Object.prototype.toString,t.data;var w=Object.create||function(t){var e=function(){};return e.prototype=t,new e},x=/[^;]+/g,S=/[^:]+/g,A=/[^-]+/g;s.init=function(t){this[0]=t},s.fn=s.init.prototype=s.prototype=y(w(t.fn),{rescan:function(){return this.clean().collect()},collect:function(t){var e=this;return a(t||this[0],function(t){return e.getAttr(t)}),this},clean:function(t){var e,n;for(n in this)this.hasOwnProperty(n)&&(e=this[n],e.removeAttr&&e.removeAttr("js"),t&&delete this[n]);return this},getAttr:function(e){if(!/text/.test(e.nodeName)){var i=this,o=t(e),s=o.attr("noscan"),a=o.attr("js");return a&&g(r(a),function(t){var n=i.hasOwnProperty(t)&&i[t];n||(n=i[t]=u(),y(n,this)),n[n.length++]=e}),s!==n?!0:n}}}),t.fn.getVM=function(t){var e;return(t||!(e=this.data("vmodel")))&&(e=this.data("vmodel",s(this[0]).collect()).data("vmodel")),e},t.fn.refresh=function(e,n){var r=this,i=r.getVM();g(e,function(e,r){if(e in i){var o,s,a,_=i[e],l=_.method,f=_.args,p=l in t.fn,v=m(r);switch(v&&(s=c(r)),!0){case p&&v&&s:if(p=t.fn[l],n&&(o=[],a=_.eq(0),g(r,function(t){var e=_.eq(t);e.length||(e=a.clone(!0,!0),o.push(e[0])),p.apply(e,f.concat(this))}),o.length)){var y=u();d.apply(y,o),_.eq(-1).after(y),d.apply(_,o)}g(_,function(e){p.apply(t(this),f.concat(r[e]))});break;case p:t.fn[l].apply(_,f.concat(r));break;default:l=r,f=l.args||h,f=m(f)?f:[f],s=c(f),g(_,function(e){l.apply(t(this),s?f[e]:f)})}return this}})};var E,k,M,P=document,C=P.getElementsByTagName("head")[0],I=P.createComment("Kill IE"),N=/\[native code\]/;N.test(Object.defineProperty)&&N.test(Object.create)?(M=!0,E=function(t,e,n){function r(){n.call(t,i,e,t.__oldValues__[e]),t.__oldValues__[e]=i,o=!0}var i=t[e]||"undefined",o=!0;delete t[e],Object.defineProperty(t,e,{get:function(){return i},set:function(t){i=t,o&&(o=!1,_(r))}})}):N.test(Object.prototype.__defineSetter__)?(M=!0,E=function(t,e,n){function r(){n.call(t,i,e,t.__oldValues__[e]),t.__oldValues__[e]=i,o=!0}var i=t[e]||"undefined",o=!0;Object.prototype.__defineGetter__.call(t,e,function(){return i}),Object.prototype.__defineSetter__.call(t,e,function(t){i=t,o&&(o=!1,_(r))})}):"onpropertychange"in C&&(E=function(t,e,r){var i;t.onpropertychange||(i={},t.onpropertychange=function(t){var e=this,o=(t||window.event).propertyName;o in this.__setters__&&(i[o]===n&&(i[o]=!0),i[o]&&(i[o]=!1,_(function(){r.call(e,e[o],o,e.__oldValues__[o]),e.__oldValues__[o]=e[o],i[o]=!0})))})}),k=function(t,e,n){var r=e.split(".");return e=r[0],r=r[1],e in t.__setters__||(t.__setters__[e]={},E(t,e,function(t,e,n){var r=this;g(r.__setters__[e],function(){this.call(r,t,e,n)})})),t.__setters__[e][r||"observe"+l()]=n,t};var q={add:function(t,e){return this.__oldValues__[t]=this[t]=e,this},remove:function(t){return"onpropertychange"in this&&this.nodeName!==n?(delete this.__oldValues__[t],this.removeAttribute(t)):(delete this.__oldValues__[t],delete this[t]),this},on:function(){var t=this,e=p.call(arguments);return 1===e.length?(e=e[0],b(e)?g(e,function(e,n){f(e)&&k(t,e,n)}):V(e)&&g(t.__oldValues__,function(n){f(n)&&k(t,n,e)})):2===e.length&&j(e[0])&&V(e[1])&&f(e[0])&&k(t,e[0],e[1]),this},off:function(){var t=this,e=p.call(arguments);return 0===e.length?g(t.__setters__,function(e){t.__setters__[e]={}}):e.length>=1&&g(e,function(){var e,n,r=this.indexOf(".");0===r?(n=this.substr(1),g(t.__setters__,function(){n in this&&delete this[n]})):r>0?(e=this.substr(0,r),n=this.substr(r+1),n in t.__setters__[e]&&delete t.__setters__[e][n]):this in t.__setters__&&(t.__setters__[this]={})}),this},each:function(t){var e=this;return g(e.__oldValues__,function(n){t.call(e,n,e[n])}),this},extend:function(){var t=p.call(arguments);return y.apply(null,[this.__oldValues__].concat(t)),y.apply(null,[this].concat(t))}};t.observe=M?function(t){var e=w(q);return e.__setters__={},e.__oldValues__=y(!0,{},t),y(e,t)}:function(t){var e=C.appendChild(P.createComment("[object Object]"));return e.__setters__={},e.__oldValues__=y(!0,{},t),y(e,q,t)},t.fn.extend({render:function(e){if(b(e)){var n=this,r=t.fn;return g(e,function(t,e){var i=r[t];i&&i[m(e)?"apply":"call"](n,e)}),this}},listen:function(e){var n=this;return t.observe(e).on(function(t,e){var r={};r[e]=t,n.refresh(r,!0)}).extend(e)}}),t.module=function(e,n){var r,i=t(e);if(i.length)return r={},r=n(r)||r,i.listen(r)}})(jQuery||Zepto,this);