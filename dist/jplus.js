/* jplus 2014-12-19 */
!function(t,n){function e(t){return function(){return Function.prototype.call.apply(t,arguments)}}function r(t){return function(n){return null==n?n:g(n)==="[object "+t+"]"}}function i(e,r,i,o){if(e==n||!O(r))return e;var s,u=e.length;if(u===+u&&u>0&&!o){for(var a=0;u>a;a+=1)if(s=r.call(i||t,e[a],a,e),s!==n)return s;return e}for(var f in e)if(b(e,f)&&(s=r.call(i||t,e[f],f,e),s!==n))return s;return e}function o(){var t,n=arguments[0];if("boolean"==typeof n&&(t=n,n=arguments[1]),"object"!=typeof n&&!O(n))return n;var e=m(arguments,t?2:1);return i(e,function(e){"object"==typeof e&&i(e,function(e,r){if(t&&"object"==typeof e){var i=n[r];return n[r]="object"==typeof i?i:{},o(t,n[r],e)}n[r]=e})}),n}function s(t){if(!x(t))return!1;var n,e,r=t.length;if(r>1){for(n=g(t[0]),e=r-1;e>=0;e--)if(g(t[e])!==n)return!1;return!0}return!0}function u(n,e,r){return n[x(e)?"apply":"call"](r||t,e)}function a(t){var n;return O(t)?(n=M(t.prototype),n=t.apply(n,m(arguments,1))||n):n="object"==typeof t?t:{},n}function f(e){var r=f.instance,a=f.alias,c={};return i(e,function(t,e){var f,h=r[e];h===n&&e in a&&(h=r[e=a[e]]),O(h)?s(t)?(c[e]=[],i(t,function(t){f=u(h,t,r),f!==n&&c[e].push(f)})):(f=u(h,t,r),f!==n&&(c[e]=f)):"object"==typeof h&&"object"==typeof t?o(h,t):r[e]=t},t,!0),c}function c(){var e=a.apply(t,arguments),r=M(c.alias);return o(function(t){if(t===n)return e;var o;return f.instance=e,f.alias=r,x(t)?(o=[],i(t,function(t){"object"==typeof t&&o.push(f(t))})):"object"==typeof t&&(o=f(t)),o},{alias:r})}function h(t){return t+Math.random().toString(36).substr(2)}function l(t){return setTimeout(t,0)}function v(t){var n;return j(t)?n=o(!0,{},t):x(t)?(n=[],i(t,function(t,e){n[e]=v(t)})):n=t,n}function p(t){if(!B.ES5&&t in I)throw Error("If you want to support IE6/7/8. The property name [ "+t+" ] can not be observed, "+"because DOM has the same property name. "+"You can use the [observe.ES5 = true] to ignore IE6/7/8.")}function _(t){this.$startNode=t,this.viewModel={}}function d(t,n,e){this.dataModel=t,this.viewModel=n,this.startNode=e}var y=Object.prototype,g=e(y.toString),b=e(y.hasOwnProperty),m=e(Array.prototype.slice),j=r("Object"),w=r("String"),O=r("Function"),x=Array.isArray||r("Array");if(!String.prototype.trim){var A=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(A,"")}}var E={keys:Object.keys||function(t){if(!j(t))return[];var n=[];for(var e in t)b(t,e)&&n.push(e);return n},values:function(t){for(var n=this.keys(t),e=n.length,r=Array(e),i=0;e>i;i+=1)r[i]=t[n[i]];return r},invert:function(t){for(var n={},e=this.keys(t),r=0,i=e.len;i>r;r++)n[t[e[r]]]=e[r];return n},parse:function(t){if(!w(t))return{};var e={},r=t.trim().split(";");return i(r,function(t){return t=t.trim().split(":"),2>t.length?e[t[0]]="":(e[t[1].trim()]=t[0].trim(),n)}),e}},M=Object.create||function(t){var n=function(){};return n.prototype=t,new n};c.alias=M({extend:function(t){return o(this,t)},each:function(t){return i(this,t)},keys:function(){return E.keys(this)},values:function(){return E.values(this)},invert:function(){return E.invert(this)},parse:function(t){return this.extend(E.parse(t))}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var n=this.length-1;n>=0;n--)if(this[n]===t)return n;return-1});var N=function(t,n,e,r){if(t===n)return 0!==t||1/t===1/n;if(null==t||null==n)return t===n;var i=g(t);if(i!==g(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!==+t?+n!==+n:0===+t?1/+t===1/n:+t===+n;case"[object Date]":case"[object Boolean]":return+t===+n}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof n)return!1;var s=t.constructor,u=n.constructor;if(s!==u&&!(O(s)&&s instanceof s&&O(u)&&u instanceof u)&&"constructor"in t&&"constructor"in n)return!1}for(var a=e.length;a--;)if(e[a]===t)return r[a]===n;e.push(t),r.push(n);var f,c;if(o){if(f=t.length,c=f===n.length)for(;f--&&(c=N(t[f],n[f],e,r)););}else{var h,l=E.keys(t);if(f=l.length,c=E.keys(n).length===f)for(;f--&&(h=l[f],c=b(n,h)&&N(t[h],n[h],e,r)););}return e.pop(),r.pop(),c};E.isEqual=function(t,n){return N(t,n,[],[])};var S,$,k=document,F=k.getElementsByTagName("head")[0],I=k.createComment("Kill IE6/7/8"),V=/\[native code\]/;V.test(Object.defineProperty)&&V.test(Object.create)?$=Object.defineProperty:V.test(Object.prototype.__defineSetter__)&&($=function(t,n,e){t.__defineGetter__(n,e.get),t.__defineSetter__(n,e.set)});var q;$?(S=!0,q=function(t,n){function e(){i(t.__events__[n],function(e){i(e,function(e){e.call(t,o,n,s)})}),s=v(o),r=!1}if(!(n in t.__events__)){var r,o=t[n],s=v(o);$(t,n,{get:function(){return o},set:function(t){o=t,r||E.isEqual(t,s)||(r=!0,l(e))}})}}):"onpropertychange"in F&&(q=function(t){function n(n,o){var s=e[n],u=t[n];E.isEqual(u,s)||(i(o,function(e){i(e,function(e){e.call(t,u,n,s)})}),e[n]=v(u),r[n]=!1)}if(!t.onpropertychange){var e={},r={};t.each(function(t,n){e[n]=v(t)}),t.onpropertychange=function(t){var e=(t||window.event).propertyName,i=this.__events__;if(e in i){if(r[e])return;r[e]=!0,l(function(){n(e,i[e])})}}}});var C={_add:function(t,n,e){p(t),q(this,t),e=e||h("observer");var r=this.__events__[t]=this.__events__[t]||{};return r[e]=r[e]||[],r[e].push(n),this},on:function(){var t,n=this,e=m(arguments),r=e.length;if(1===r)j(t=e[0])?i(t,function(t,e){n.on(e,t)}):O(t)&&this.each(function(e,r){n._add(r,t,"__all__")});else if(2===r){if(!O(e[1]))return this;if(w(t=e[0])){var o=t.indexOf(".");0>=o?this._add(t,e[1]):this._add(t.substr(0,o),e[1],t.substr(o+1))}else x(t)&&i(t,function(t){n.on(t,e[1])})}return this},_bang:function(t,n,e){var r=this,o=r[t];i(this.__events__[t][e],function(e){e.call(r,n,t,o)})},trigger:function(t,n){var e,r=this;return t?(w(t)?(e=t.indexOf("."),e>0?this._bang(t.substr(0,e),n,t.substr(e+1)):e?i(this.__events__[t]||[],function(e,i){r._bang(t,n,i)}):(t=t.substr(1),i(this.__events__,function(e,o){i(e,function(e,i){i===t&&r._bang(o,n,i)})}))):x(t)&&i(t,function(t){r.trigger(t,n)}),this):this},_remove:function(t,n,e){var r=this.__events__[t][e]||[],i=r.indexOf(n);return-1!==i&&r.splice(i,1),this},off:function(){var t,n,e=this,r=m(arguments),o=r.length;if(o){if(1===o)O(t=r[0])?i(this.__events__,function(n,r){i(n,function(n,i){e._remove(r,t,i)})}):w(t)&&(n=t.indexOf("."),0>=n?this.__events__[t]={}:delete this.__events__[t.substr(0,n)][t.substr(n+1)]);else if(2===o){if(!O(r[1]))return this.off(r[0]),this;w(t=r[0])?(n=t.indexOf("."),0>=n?i(this.__events__[t],function(n,i){e._remove(t,r[1],i)}):this._remove(t.substr(0,n),r[1],t.substr(n+1))):x(t)&&i(t,function(t){e.off(t,r[1])})}}else this.__events__={};return this},offAll:function(){var t=this;return i(this.__events__,function(n,e){t.off([e,"__all__"].join("."))}),this},each:function(t){var n=this;if(this.nodeName)for(var e in this)-1!==n.filter.indexOf(e)||e in I||t.call(n,this[e],e);else i(this,function(e,r){-1===n.filter.indexOf(r)&&t.call(n,e,r)});return this},extend:function(){return o.apply(t,[this].concat(m(arguments)))},once:function(t,n){function e(){n.apply(r,arguments),r.off(e)}var r=this;return t+=".once",this.on(t,e)},tie:function(t,n){if(!O(n))return this;if(x(t)){var e=this,r=t.length,o=[],s=[],u=function(u,a){0>o.indexOf(a)?(o.push(a),o.length===r&&(i(t,function(t,n){t=t.split(".")[0],s[n]=e[t]}),n.apply(e,s))):o.length>=r&&(o.length=0,o.push(a))};return this.on(t,u)}return w(t)?(t=t.split(" "),t.length>1?this.tie(t,n):this.on(t[0],n)):this},collect:function(t,n,e){function r(t){o.push(t),o.length===n&&(e.apply(i,o),i.off(r))}var i=this,o=[];return this.on(t,r)}};C.bind=C.on,C.unbind=C.off,C.fire=C.trigger,C.filter=E.keys(C).concat(["__events__","filter"]);var B=S?function(t,n){if(!j(t))return{};var e=o(M(C),t,{__events__:{}});return j(n)||O(n)?e.on(n):e}:function(t,n){if(!j(t))return{};var e=o(F.appendChild(k.createComment("[object Object]")),C,t,{__events__:{}});return j(n)||O(n)?e.on(n):e};B.ES5=!1,B.fn=C;var D=window.jQuery||window.Zepto;if(D===n)return O(t.define)&&(define.amd||define.cmd)?define({agent:c,observe:B}):(t.agent=c,t.observe=B,t.$$===n&&(t.$$=c)),n;D.agent=c,D.observe=B;var P=D.plus={attr:"js",filterAttr:["noscan","app"],debug:!1,viewModel:[]},T=e(Array.prototype.push);_.prototype={filter:function(t){var n=[],e=this.$startNode[0],r=e.id=e.id||"filter_id_for_scaner";return i(P.filterAttr,function(t){var e=D([r,"["+t+"]","["+P.attr+"]"].join(" "));n.push.apply(n,m(e))}),"filter_id_for_scaner"===r&&(e.removeAttribute?e.removeAttribute("id"):e.id=""),t.filter(function(){return-1===n.indexOf(this)})},parse:function(t){var e=this.viewModel;return i(E.parse(t.attr(P.attr)),function(r,i){var o=e[i]=e[i]||{};o.instance?T(o.instance,t[0]):(r=r.split("-"),o.method=r[0],o.params=r.slice(1),o.instance=t,o.lastValue=null,o.alive=t.attr("unalive")!==n?!1:!0,o.template=t.clone())}),this},scan:function(){var t=this;return this.parse(this.$startNode).filter(this.$startNode.find("["+P.attr+"]")).each(function(){var n=D(this);n.prevObject=n.context=null,t.parse(n)}),this},rescan:function(){return this.viewModel={},this.scan()},get:function(){return this.viewModel}},D.fn.scanView=function(){var t=new _(this);if(D.plus.debug){var n=this[0];P.viewModel[n.vmIndex="number"==typeof n.vmIndex?n.vmIndex:P.viewModel.length]=t}return t.scan().get()};var G=D.fn;d.prototype={refresh:function(){var t=this.viewModel,n=this.dataModel;for(var e in n)e in t&&this.render(t[e],n[e],e)},render:function(t,n){if(!E.isEqual(n,t.lastValue)){t.lastValue="object"==typeof n?x(n)?n.concat():o(!0,{},n):n;var e=t.instance,r=t.method,i=t.params;if(t.method in G)if(r=G[r],s(n)){var u,a,f=e.length,c=n.length;if(t.alive)if(f>=c)for(e.slice(c).remove(),a=0;c>a;a+=1)u=D(e[a]),r.apply(u,i.concat(n[a]));else{var h=t.template,l=k.createDocumentFragment();for(a=0;c>a;a+=1)u=f>a?D(e[a]):h.clone().each(function(){T(e,l.appendChild(this))}),r.apply(u,i.concat(n[a]));if(l.childNodes.length){var v,p=e[f-1];(v=p.nextSibling)?p.parentNode.insertBefore(l,v):p.parentNode.appendChild(l)}h=l=null}else{var _=Math.min(f,c);for(a=0;_>a;a+=1)u=D(e[a]),r.apply(u,i.concat(n[a]))}}else r.apply(e,i.concat(n));else{if(!O(n))return;r=n,i=this.dataModel[t.method],r.apply(e,[].concat(i||[]))}}}},D.fn.refresh=function(t){var n=this,e=this[0];return j(t)?new d(t,this.scanView(),e).refresh():x(t)&&i(t,function(t,r){new d(t,n.eq(r).scanView(),e).refresh()}),this},o(D.fn,{render:function(t){function n(t,n){var i=r[n];O(i)&&i[x(t)?"apply":"call"](e,t)}var e=this,r=D.fn;return j(t)?i(t,n):x(t)&&i(t,function(t){j(t)&&i(t,n)}),this},listen:function(t){var n=this;return n.refresh(t),D.observe(t,function(t,e){var r={};r[e]=t,n.refresh(r)})}}),D.define=function(t,e){var r,i=D(t);return i.length?(r={},r=e(r)||r,i.listen(r)):n},D.render=function(t){return D("[render]").each(function(){var n,e=D(this),r=e.attr("render");r in t&&j(n=t[r])&&e.render(n)}),this};var K={vmodel:{},ready:function(t){var n=this;return D(document).ready(function(){t.call(n.$scan())}),this},$scan:function(){var t=this;return D("[app]").each(function(){var n=D(this),e=n.attr("app"),r=!1;t.vmodel[e]=n.scanView(),t.on(e+".module",function(t,e){!r&&j(t)&&(r=!0,this[e]=n.listen(t),r=!1)})}),this}};D.module=D.observe(K)}(this);